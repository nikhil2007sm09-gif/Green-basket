<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GreenBasket | Admin Enterprise Plus</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
    /* --- UNIVERSAL RESET & VARIABLES --- */
:root { 
    --primary: #16a34a; 
    --secondary: #3b82f6; 
    --danger: #ef4444; 
    --warning: #f59e0b; 
    --bg: #f0f4f8; 
    --card: #ffffff; 
    --text: #334155;
}

.dark-theme { 
    --bg: #0f172a; 
    --card: #1e293b; 
    --text: #f1f5f9; 
    --border: #334155;
}

* { 
    box-sizing: border-box; 
    font-family: 'Poppins', sans-serif; 
    margin: 0; 
    padding: 0; 
    transition: background 0.3s, color 0.3s; 
}

body { 
    background: var(--bg); 
    padding: 15px; 
    color: var(--text); 
    overflow-x: hidden;
}

.container { 
    max-width: 1200px; 
    margin: auto; 
}

/* --- HEADER --- */
.header { 
    display: flex; 
    justify-content: space-between; 
    align-items: center; 
    margin-bottom: 20px; 
    background: var(--card); 
    padding: 15px 20px; 
    border-radius: 20px; 
    box-shadow: 0 4px 15px rgba(0,0,0,0.05); 
}

.logout-link {
    padding: 8px 15px;
    background: rgba(239, 68, 68, 0.1);
    color: var(--danger) !important;
    border: 1px solid var(--danger);
    text-decoration: none;
    border-radius: 50px;
    font-weight: 600;
    font-size: 0.85rem;
}

/* --- STATS BOXES --- */
.stats-row { 
    display: grid; 
    grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); 
    gap: 15px; 
    margin-bottom: 20px; 
}

.stat-item { 
    background: var(--card); 
    padding: 20px; 
    border-radius: 20px; 
    text-align: center; 
    box-shadow: 0 5px 15px rgba(0,0,0,0.03);
}

.stat-item i { color: var(--primary); margin-bottom: 8px; font-size: 1.2rem; }
.stat-value { font-size: 1.3rem; font-weight: 800; display: block; }
.stat-item label { font-size: 0.75rem; opacity: 0.7; font-weight: 600; text-transform: uppercase; }

/* --- MAIN LAYOUT GRID --- */
.main-grid { 
    display: grid; 
    grid-template-columns: 350px 1fr; 
    gap: 20px; 
}

.card { 
    background: var(--card); 
    padding: 20px; 
    border-radius: 24px; 
    box-shadow: 0 10px 25px rgba(0,0,0,0.05); 
    height: fit-content;
}

/* --- INPUTS & BUTTONS --- */
input, select { 
    width: 100%; 
    padding: 12px; 
    margin-bottom: 12px; 
    background: var(--bg); 
    border: 1px solid #e2e8f0; 
    border-radius: 12px; 
    color: var(--text); 
    outline: none;
}

.dark-theme input, .dark-theme select { border-color: #334155; }

.btn { 
    width: 100%; 
    padding: 12px; 
    border: none; 
    border-radius: 12px; 
    cursor: pointer; 
    font-weight: 700; 
    display: flex; 
    align-items: center; 
    justify-content: center; 
    gap: 8px; 
}

.btn-primary { background: var(--primary); color: white; }
.theme-toggle { 
    background: #e2e8f0; border: none; padding: 10px; border-radius: 10px; cursor: pointer; 
}
.dark-theme .theme-toggle { background: #334155; color: white; }

/* --- PRODUCT LIST ITEMS --- */
.product-item { 
    display: flex; 
    align-items: center; 
    justify-content: space-between; 
    background: var(--bg); 
    padding: 12px; 
    border-radius: 15px; 
    margin-bottom: 10px; 
}

.p-img { width: 50px; height: 50px; border-radius: 10px; object-fit: cover; }

.filter-pill { 
    padding: 6px 15px; 
    background: var(--bg); 
    border-radius: 50px; 
    font-size: 0.8rem; 
    cursor: pointer; 
    font-weight: 600; 
}
.filter-pill.active { background: var(--primary); color: white; }

/* --- TABLE RESPONSIVENESS --- */
.summary-table { 
    width: 100%; 
    border-collapse: collapse; 
    margin-top: 15px; 
}
.summary-table th { background: var(--primary); color: white; padding: 12px; text-align: left; font-size: 0.8rem; }
.summary-table td { padding: 12px; border-bottom: 1px solid rgba(0,0,0,0.05); font-size: 0.8rem; }

/* --- MEDIA QUERIES --- */

/* For Tablets (992px and below) */
@media (max-width: 992px) {
    .main-grid { grid-template-columns: 1fr; }
}

/* For Mobile (600px and below) */
@media (max-width: 600px) {
    body { padding: 10px; }
    
    .header { 
        flex-direction: column; 
        text-align: center; 
        gap: 15px;
    }

    .stats-row { 
        grid-template-columns: 1fr 1fr; /* 2 boxes per row on mobile */
    }

    .product-item {
        flex-direction: column;
        text-align: center;
        gap: 10px;
    }

    .product-item div {
        flex-direction: column;
    }

    .summary-table {
        display: block;
        overflow-x: auto; 
    }
    
    .card { padding: 15px; }
    
    #catFilters { 
        display: flex; 
        gap: 5px; 
        overflow-x: auto; 
        padding-bottom: 5px; 
    }
}  
    </style>
</head>

<body>

    <div class="container">
        <header class="header">
            <div>
                <h2><i class="fas fa-store"></i> GreenBasket</h2>
                <p id="date-now" style="font-size: 0.8rem; opacity: 0.7;"></p>
            </div>
            <div style="display:flex; gap:12px; align-items: center;">
                <button class="theme-toggle" onclick="toggleTheme()"><i class="fas fa-moon"></i></button>
                <button class="btn btn-primary" style="width:auto; padding: 10px 20px;" onclick="exportData()"><i
                        class="fas fa-file-download"></i></button>
                <a href="index.html" class="logout-link">
                    <i class="fas fa-power-off"></i> Logout
                </a>
            </div>
        </header>

        <div class="stats-row">
            <div class="stat-item"><i class="fas fa-boxes"></i><span class="stat-value"
                    id="count">0</span><label>Items</label></div>
            <div class="stat-item"><i class="fas fa-calculator"></i><span class="stat-value"
                    id="avg-price">‚Çπ0</span><label>Avg Price</label></div>
            <div class="stat-item"><i class="fas fa-layer-group"></i><span class="stat-value"
                    id="cat-count">0</span><label>Cats</label></div>
            <div class="stat-item"><i class="fas fa-chart-pie"></i><span class="stat-value"
                    id="total-val">‚Çπ0</span><label>Stock Value</label></div>
        </div>

        <div class="main-grid">
            <div class="card">
                <h3 id="form-title">Product Manager</h3>
                <input type="hidden" id="edit-id">
                <input type="text" id="pName" placeholder="Item Name">
                <input type="number" id="pPrice" placeholder="Price (‚Çπ)">
                <select id="pCat">
                    <option value="Vegetables">Vegetables ü•¶</option>
                    <option value="Fruits">Fruits üçé</option>
                    <option value="Dairy">Dairy & Eggs ü•õ</option>
                    <option value="Bakery">Bakery üçû</option>
                </select>
                <input type="text" id="pImg" placeholder="Image URL">
                <button class="btn btn-primary" id="save-btn" onclick="saveProduct()"><i class="fas fa-plus"></i> Save
                    Item</button>
                <button class="btn" id="cancel-btn" style="display:none; margin-top:10px;"
                    onclick="resetForm()">Cancel</button>
            </div>

            <div class="card">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
                    <div id="catFilters">
                        <div class="filter-pill active" onclick="filterByCat('All', this)">All</div>
                        <div class="filter-pill" onclick="filterByCat('Vegetables', this)">Veg</div>
                        <div class="filter-pill" onclick="filterByCat('Fruits', this)">Fruits</div>
                    </div>
                    <input type="text" id="searchInput" placeholder="Search..." onkeyup="render()"
                        style="width:150px; margin:0;">
                </div>
                <div id="inventoryList" style="max-height: 400px; overflow-y: auto;"></div>
            </div>
        </div>

        <div class="card" style="margin-top: 20px;">
            <h3><i class="fas fa-table"></i> Detailed Inventory Analysis</h3>
            <table class="summary-table">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Product Name</th>
                        <th>Category</th>
                        <th>Price</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody id="summary-body">
                </tbody>
            </table>
        </div>
    </div>

    <audio id="successSound" src="https://assets.mixkit.co/active_storage/sfx/2354/2354-preview.mp3"></audio>

    <script>
        let currentFilter = 'All';

        function toggleTheme() { document.body.classList.toggle('dark-theme'); }

        function filterByCat(cat, el) {
            currentFilter = cat;
            document.querySelectorAll('.filter-pill').forEach(p => p.classList.remove('active'));
            el.classList.add('active');
            render();
        }

        function saveProduct() {
            const name = document.getElementById('pName').value;
            const price = document.getElementById('pPrice').value;
            const cat = document.getElementById('pCat').value;
            const img = document.getElementById('pImg').value;
            const editId = document.getElementById('edit-id').value;

            if (!name || !price || !img) return alert("Fill all details!");

            let products = JSON.parse(localStorage.getItem('myProducts')) || [];

            if (editId) {
                const index = products.findIndex(p => p.id == editId);
                products[index] = { name, price: parseFloat(price), cat, img, id: parseInt(editId) };
            } else {
                products.push({ name, price: parseFloat(price), cat, img, id: Date.now() });
                document.getElementById('successSound').play(); 
            }

            localStorage.setItem('myProducts', JSON.stringify(products));
            resetForm();
            render();
        }

        function editProduct(id) {
            let products = JSON.parse(localStorage.getItem('myProducts')) || [];
            const p = products.find(p => p.id == id);
            document.getElementById('pName').value = p.name;
            document.getElementById('pPrice').value = p.price;
            document.getElementById('pCat').value = p.cat;
            document.getElementById('pImg').value = p.img;
            document.getElementById('edit-id').value = p.id;
            document.getElementById('cancel-btn').style.display = "block";
        }

        function resetForm() {
            document.getElementById('edit-id').value = "";
            document.querySelectorAll('input').forEach(i => i.value = "");
            document.getElementById('cancel-btn').style.display = "none";
        }

        function deleteProduct(id) {
            if (!confirm("Delete?")) return;
            let products = JSON.parse(localStorage.getItem('myProducts')) || [];
            products = products.filter(p => p.id !== id);
            localStorage.setItem('myProducts', JSON.stringify(products));
            render();
        }

        function render() {
            const term = document.getElementById('searchInput').value.toLowerCase();
            const products = JSON.parse(localStorage.getItem('myProducts')) || [];
            const list = document.getElementById('inventoryList');
            const tableBody = document.getElementById('summary-body');
            let total = 0;

            list.innerHTML = "";
            tableBody.innerHTML = "";

            let filtered = products.filter(p =>
                (currentFilter === 'All' || p.cat === currentFilter) &&
                p.name.toLowerCase().includes(term)
            );

            filtered.forEach((p, index) => {
                total += p.price;

                
                list.innerHTML += `
                    <div class="product-item">
                        <div style="display:flex; gap:15px; align-items:center;">
                            <img src="${p.img}" class="p-img" onerror="this.src='https://via.placeholder.com/60'">
                            <div>
                                <h4>${p.name}</h4>
                                <small>${p.cat}</small>
                            </div>
                        </div>
                        <div style="display:flex; align-items:center; gap:10px;">
                            <b>‚Çπ${p.price}</b>
                            <button class="theme-toggle" onclick="editProduct(${p.id})"><i class="fas fa-edit"></i></button>
                            <button class="theme-toggle" style="color:red" onclick="deleteProduct(${p.id})"><i class="fas fa-trash"></i></button>
                        </div>
                    </div>
                `;


              
                const status = p.price > 100 ? '<span style="color:orange">Premium</span>' : '<span style="color:green">Budget</span>';
                tableBody.innerHTML += `
                    <tr>
                        <td>#${index + 1}</td>
                        <td>${p.name}</td>
                        <td>${p.cat}</td>
                        <td>‚Çπ${p.price}</td>
                        <td>${status}</td>
                    </tr>
                `;
            });

            document.getElementById('count').innerText = products.length;
            document.getElementById('total-val').innerText = '‚Çπ' + total.toLocaleString();
            document.getElementById('avg-price').innerText = '‚Çπ' + (products.length > 0 ? (total / products.length).toFixed(0) : 0);
        }

        function exportData() {
            const data = localStorage.getItem('myProducts');
            const blob = new Blob([data], { type: 'application/json' });
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = 'greenbasket_final.json';
            a.click();
        }

        window.onload = render;
        document.getElementById('date-now').innerText = new Date().toDateString();
    </script>
</body>

</html>